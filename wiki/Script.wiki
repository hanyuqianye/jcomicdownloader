#summary One-sentence summary of this page.

= Introduction =

Add your content here.


= Details =

<div>JComicDownloader自4.08版起，提供任務結束後執行腳本的功能選項，可在任務結束後自動轉換圖片格式或尺寸、ADSL斷線重新連線、電腦休眠或關機等等。依照設定，可在每個任務完成後執行腳本，<b><font color="#38761d">此時腳本會自動在此任務下載資料夾內執行</font></b>，便於處理剛下載好的圖片或文字檔；或者可以選擇在不任務完成後執行腳本，此時腳本的執行預設位置與程式所在位置相同。</div>
<div><br>
</div>
<div><br>
</div>
<div>以下示範簡易設定步驟：</div>
<div><br>
</div>
<div>1. 開啟JComicDownloader，打開「選項」視窗，進入「腳本」分頁後，點擊「選擇腳本」按鈕：</div>
<div>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A02%3A30_%E9%81%B8%E9%A0%85%E8%A8%AD%E5%AE%9A_001.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A02%3A30_%E9%81%B8%E9%A0%85%E8%A8%AD%E5%AE%9A_001.png"></a></div>
<br>
</div>
<div><br>
</div>
<div>2. 出現選擇檔案視窗，選擇欲執行的腳本檔案後，按確定：</div>
<div>（<b>注意：腳本檔案的副檔名只能為<font color="#ff0000">sh（Unix-like系統下使用）</font>或<font color="#ff0000">bat（Windows系統下專用）</font></b>）</div>
<div>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A02%3A51_%E9%81%B8%E6%93%87%E8%85%B3%E6%9C%AC%E6%AA%94_001.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A02%3A51_%E9%81%B8%E6%93%87%E8%85%B3%E6%9C%AC%E6%AA%94_001.png"></a></div>
<br>
</div>
<div><br>
</div>
<div>3. 依照需求，對「每個任務完成後執行此腳本」或「全部任務完成後執行此腳本」作勾選動作：</div>
<div>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A03%3A11_%E9%81%B8%E9%A0%85%E8%A8%AD%E5%AE%9A_001.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A03%3A11_%E9%81%B8%E9%A0%85%E8%A8%AD%E5%AE%9A_001.png"></a></div>
<br>
</div>
<div><br>
</div>
<div>4. 設定好腳本語言（<font color="#38761d"><b>注意：Windows系統下無須選擇</b></font>）和「任務腳本執行等待時間」之後，按確定：</div>
<div>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A03%3A19_%E9%81%B8%E9%A0%85%E8%A8%AD%E5%AE%9A_001.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A03%3A19_%E9%81%B8%E9%A0%85%E8%A8%AD%E5%AE%9A_001.png"></a></div>
<br>
</div>
<div><br>
</div>
<div>5. 此時方可進行下載，任務完成後會在下方顯示腳本的執行進度：</div>
<div>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A04%3A24_JComicDownloader%20%20v4.08_001.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/20120607_23%3A04%3A24_JComicDownloader%20%20v4.08_001.png"></a></div>
<br>
</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
<div>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/042.gif?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/042.gif"></a><a href="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/042.gif?attredirects=0" imageanchor="1" style="background-color:rgb(255,255,255)"><img border="0" src="https://sites.google.com/site/jcomicdownloader/step-by-step/how-to-set-script/042.gif"></a></div>
<br>
</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
<div>以下展示各功能的腳本範例：</div>
<div><br>
</div>
<br>
<div><b><font color="#0000ff">範例1：修改圖片尺寸和格式</font></b>
</div>
<div>
<div><br>
Windows：</div>
<div style="overflow:auto;width:auto;background-color:white;border-style:solid;border-color:gray;border-width:0.1em 0.1em 0.1em 0.8em;padding:0.2em 0.6em">
<pre style="margin-top:0px;margin-bottom:0px;line-height:20px"><pre style="line-height:normal;margin-top:0px;margin-bottom:0px"><span style="color:rgb(128,128,128);line-height:20px;background-color:white">REM</span><font color="#808080"><span style="line-height:20px"> 功能：修改圖片尺寸和格式</span></font></pre><pre style="line-height:normal;margin-top:0px;margin-bottom:0px"><pre style="margin-top:0px;margin-bottom:0px"><span style="color:rgb(128,128,128);line-height:20px;background-color:white">REM</span><font color="#808080"><span style="line-height:20px"> 附註：需下載ImageMagick並指定程式位置（或修改環境變數）</span></font></pre></pre>
<span style="color:rgb(128,128,128)">REM jpg轉png，且將圖片尺寸改為1000x1500</span>
<span style="background-color:rgb(255,240,240)">"C:\cmd\ImageMagick-6.7.7-5\mogrify.exe"</span> -format png -resize <span style="color:rgb(96,0,224);font-weight:bold">1000</span>x<span style="color:rgb(96,0,224);font-weight:bold">1500</span> *.jpg
<span style="color:rgb(128,128,128)">REM 刪除此資料夾內所有jpg檔</span>
rm *.jpg
</pre>
</div>
<div><br>
</div>
</div>
<div>Linux：</div>

<div style="overflow:auto;width:auto;background-color:white;border-style:solid;border-color:gray;border-width:0.1em 0.1em 0.1em 0.8em;padding:0.2em 0.6em;background-repeat:initial initial">
<pre style="margin:0px"><span style="line-height:125%;color:rgb(128,128,128)">#!/bin/bash</span><span style="line-height:125%">
</span><font color="#808080"><span style="line-height:20px"># 功能：修改圖片尺寸和格式</span></font></pre>
<pre style="margin:0px"><pre style="margin-top:0px;margin-bottom:0px"><font color="#808080"><span style="line-height:20px"># 附註：需先安裝ImageMagick</span></font></pre><pre style="line-height:125%;margin-top:0px;margin-bottom:0px"><font color="#808080"><br></font></pre></pre>
<pre style="margin:0px;line-height:125%"><span style="color:rgb(128,128,128)"># jpg轉png，且將圖片尺寸改為1000x1500</span>
mogrify -format png -resize 1000x1500 *.jpg *.JPG; 
<span style="color:rgb(128,128,128)"># 刪除此資料夾內所有副檔名為jpg的檔案 </span>
rm *.jpg; 
<span style="color:rgb(128,128,128)"># 刪除此資料夾內所有副檔名為JPG的檔案 </span>
rm *.JPG; 
</pre>
</div>



<div><br>
</div>
<div><br>
</div>
<div><b><font color="#0000ff">範例2：將ADSL重新連線</font></b></div>
<div><b><font color="#38761d">（注意1：若要使用此腳本，請先取消Proxy設定，否則無法重新連線）</font></b></div>
<div><b><font color="#38761d">（注意2：若要使用此腳本，須設定任務腳本執行等待時間，給予系統一段連線緩衝）</font></b></div>

<div><br>
</div>
<div>Windows：</div>
<div style="overflow:auto;width:auto;background-color:white;border-style:solid;border-color:gray;border-width:0.1em 0.1em 0.1em 0.8em;padding:0.2em 0.6em;background-repeat:initial initial">
<pre style="color:black;margin:0px;line-height:125%"><span style="color:#808080">REM 功能：ADSL重新連線</span>
<span style="color:#808080">REM 附註：連線名稱請自行代入自己的ADSL連線名稱 ex. Hinet，且需設定為無提示名稱密碼，方可直接連線。</span></pre>
<pre style="color:black;margin:0px;line-height:125%"><span style="color:#808080"><br></span></pre>
<pre style="margin:0px;line-height:125%">RasPhone -h <span style="color:black;background-color:rgb(255,240,240)">"連線名稱"</span>
RasPhone -d <span style="color:black;background-color:rgb(255,240,240)">"連線名稱"</span>
</pre>
</div>

<div><br>
</div>
<div>Linux：</div>
<div style="background:#ffffff;overflow:auto;width:auto;color:black;background:white;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em">
<pre style="margin:0;line-height:125%"><span style="color:#808080">#!/bin/bash</span>
<span style="color:#808080"># 功能：ADSL斷線重連</span>
<span style="color:#808080"># 附註：需安裝並設置PPPoEConf作為預設連線工具</span>

<span style="color:#808080"># 將目前的ADSL斷線</span>
<span style="color:#007020">echo </span>使用者密碼 | sudo -S poff dsl-provider
<span style="color:#808080"># 重新進行ADSL連線</span>
<span style="color:#007020">echo </span>使用者密碼 | sudo -S pon dsl-provider
</pre>
</div>
<div><br>
</div>
<div><br>
</div>
<div><b><font color="#0000ff">範例3：將電腦暫停</font></b></div>
<div><br>
</div>
<div>Linux：</div>
<div style="overflow:auto;width:auto;background-color:white;border-style:solid;border-color:gray;border-width:0.1em 0.1em 0.1em 0.8em;padding:0.2em 0.6em;background-repeat:initial initial">
<pre style="color:black;margin:0px;line-height:125%"><span style="color:#808080">#!/bin/bash</span>
<span style="color:#808080"># 功能：將電腦暫停</span></pre>
<pre style="margin:0px;line-height:125%"><pre style="margin-top:0px;margin-bottom:0px;line-height:26px"><span style="color:rgb(128,128,128)"># 附註：需安裝powermanagement-interface</span></pre><pre style="margin-top:0px;margin-bottom:0px;line-height:26px"><span style="color:rgb(128,128,128)"><br></span></pre>pmi action <span style="color:rgb(0,112,32)">suspend</span>
</pre>
</div>
<div><br>
</div>
<div><br>
</div>
